%
\documentclass[a4paper,12pt,twoside]{article}
\input{configuration/preamble.tex}
\input{configuration/teaching/preamble-practices}

\setboolean{ShowHint}{true}
\setboolean{ShowSolution}{true}

\renewcommand{\PracticeSubject}{Дискретная математика}
\renewcommand{\PracticeName}{Частичные порядки. Начало.}
\renewcommand{\PracticeGroup}{ПАДИИ}
\renewcommand{\PracticeCourse}{1}
\renewcommand{\PracticeDate}{7 февраля 2025}

\usetikzlibrary{fadings}
\usetikzlibrary{patterns}
\usetikzlibrary{shadows.blur}
\usetikzlibrary{shapes}

\begin{document}
\begin{?}
    Опуская требование антисимметричности в определении частичного порядка, получаем определение предпорядка. Докажите, что любой предпорядок устроен так: множество делится на непересекающиеся классы, при этом \(x \preceq y\) для любых двух элементов \(x\), \(y\) из одного класса, а на фактор-множестве задан частичный порядок, который и определяет результат сравнения двух элементов из разных классов.
\end{?}
\begin{solution}{}
    Пусть на \(X\) задано отношение \(\prec\) которое является рефлексивным и транзитивным. Введем на \(X\) отношение \(\sim\):
    \[
        \forall x, y \in X: x \sim y \overset{\text{\tiny def}}{\Leftrightarrow} x \preceq y \text{ и } y \preceq x.
    \]
    Проверим что \(\sim\) --- отношение эквивалентности. Рефлексивность следует из рефлексивности \(\preceq\). Симметричность очевидна. Осталось проверить транзитивность. Пусть \(x \sim y\) и \(y \sim z\). Тогда, в частности, \(x \preceq y\) и \(y \preceq z\), откуда по транзитивности \(\preceq\) \(x \preceq z\). Аналогично, \(z \preceq y\) и \(y \preceq x\), значит \(z \preceq x\), и поэтому \(x \sim z\). Значит \(\sim\) действительно отношение эквивалентности.
    
    Рассмотрим фактор-множество \(X / \sim\), класс эквивалентности элемента \(x \in X\) обозначим как \([x]\). На классах эквивалентности введем отношение:
    \[ 
        \forall x, y \in X: [x] \leq [y] \overset{\text{\tiny def}}{\Leftrightarrow} x \preceq y
    \]
    Для начала необходимо проверить корректность такого определения: что при замене представителя класса на другой, результат не изменится. Действительно, пусть \(x \sim z\) и \([x] \leq [y]\). Тогда, в частности, \(z \preceq x \preceq y\) и значит \([z] \leq [y]\): т{.}е{.}~если \([x] = [z]\) и \([x] \leq [y]\), то \([z] \leq [y]\). Для правой части корректность проверяется аналогично. 

    Теперь необходимо проверить что данное отношение задает частичный порядок на классах эквивалентности. Рефлексивность и транзитивность следуют из рефлексивности и транзитивности \(\preceq\). Необходимо проверить антисимметричность. Пусть \([x] \leq [y]\) и \([y] \leq [x]\). Тогда \(x \preceq y\) и \(y \preceq x\), а значит \(x \sim y\), т.е. \([x] = [y]\), что и означает антисимметричность.
\end{solution}
\begin{?}
    Докажите, что в частично упорядоченном множестве \(\N \times \N\) (порядок покоординатный) нет бесконечного подмножества, любые два элемента которого были бы несравнимы. Верно ли аналогичное утверждение для \(\Z \times \Z\)?
\end{?}
\begin{solution}{}
    Напомним что покоординатный порядок означает что 
    \[
        (n_1, m_1) \preceq (n_2, m_2) \overset{\text{\tiny def}}{\Leftrightarrow} \begin{cases}
            n_1 \leq n_2 \\
            m_1 \leq m_2
        \end{cases}
    \]
    Ответим сначала на вопрос для \(\Z \times \Z\). Любые два элемента множества  
    \[
        A = \set{(m, -m) | m \in \Z}
    \]
    будут несравнимы между собой, поэтому в \(\Z \times \Z\) такое множество есть. Теперь рассмотрим произвольное множество попарно несравнимых элементов в \(\N \times \N\), обозначим его \(A\). Рассмотрим какую-нибудь пару в \(A\), обозначим её \(n_0, m_0\). Теперь поймем что все остальные точки лежат либо выше, но левее чем \((n_0, m_0)\), либо правее, но ниже чем \((n_0, m_0)\).
    \begin{center}
        \includetikz{practice-04-solution-img-01.tikz}
    \end{center}
    При этом никакие точки из \(A\) не могут иметь одинаковые значения по первой или второй компоненте. Поэтому в \(A\) будет не более чем 
    \[
        \underbrace{(n_0 - 1)}_{\text{выше и левее}} + \underbrace{(m_0 - 1)}_{\text{ниже и правее}} + 1 
    \]
    элементов, и значит \(A\) конечно.
\end{solution}
\begin{?}
    Сколько существует различных линейных порядков на множестве из \(n\) элементов?
\end{?}
\begin{solution}{}
    Чтобы задать линейный порядок, нужно указать элемент который будет минимальным, это можно сделать \(n\) способами. После этого нужно указать элемент, следующий за минимальным, это можно сделать \(n - 1\) способами. Продолжая, получаем \(n!\) различных линейных порядков. 
\end{solution}
\begin{?}
    Пусть \(U\) --- конечное множество из \(n\) элементов. Рассмотрим множество \(\mathcal{P}(U)\) всех подмножеств множества \(U\), упорядоченное по включению. Какова максимально возможная мощность множества \(\mathcal{S} \subset \mathcal{P}(U)\), если никакие два элемента \(S\) не сравнимы?
\end{?}
\begin{solution}{}
    Напомним что цепью в частично-упорядоченном множестве \((X, \preceq)\) называется набор элементов в котором любые два сравнимы между собой. Иначе говоря, цепь \(L \subset X\) это любое линейно-упорядоченное подмножество \(X\). В свою очередь, антицепью называется любое подмножество элементов, которые между собой не сравнимы.  На теоретико-множественном языке, задача звучит так: \textit{какой максимальный размер антицепи в \(\mathcal{P}(U), \subseteq\) если \(|U| = n\)}?

    Для начала рассмотрим частный случай для \(n = 3\). Нарисуем множество \(\mathcal{P}(\set{a, b, c})\) (на рисунке стрелка \(A \to B\) означает что \(A \subset B\)). На этом рисунке опущены петли, серым отмечены включения, которые в дальнейшем будут опускаться, для простоты рисунка.
    \begin{center}
        \scalebox{0.75}{\includetikz{practice-04-solution-img-02.tikz}}
    \end{center}
    Изобразим все возможные антицепи в этом множестве:
    \begin{center}
        \vspace{6pt}
        \includetikz{practice-04-solution-img-03.tikz}
        \vspace{6pt}
    \end{center}
    Получается что максимальная антицепь состоит из всех одноэлементных или двухэлементных множеств. Вообще говоря, в \(\mathcal{P}(U), |U| = n\) будут антицепи размера \(C_n^k\), состоящие из всех \(k\)-элементных множеств, в частности среди таких антицепей, максимальной будет, та, у которой размер \(C_{n}^{\ceil{\lfrac{n}{2}}}\). Покажем теперь что это --- самая большая антицепь в \(\mathcal{P}(U)\). 
    
    Для этого воспользуемся принципом Дирихле, и покажем следующую вещь. Пусть \(|U| = n\) и \(L_1, \ldots, L_s\) --- цепи в \(\mathcal{P}(U)\), такие, что:
    \[
        \bigcup_{i = 1}^{s} L_i = \mathcal{P}(U)
    \]
    Иначе говоря, эти \(s\) цепей исчерпывают (покрывают) все элементы  \(\mathcal{P}(U)\). Тогда, если \(X \subset \mathcal{P}(U)\) (т.е. \(X\) --- некоторая коллекция подмножеств \(U\)), и \(|X| > s\), то по принципу Дирихле, какие-то два элемента из \(X\) лежат в одном \(L_i\), и, следовательно, сравнимы между собой. Поэтому если \(X\) --- антицепь в \(\mathcal{P}(U)\), то \(|X| \leq s\). Осталось доказать что множество \(\mathcal{P}(U)\) можно исчерпать \(C_{n}^{\ceil{\lfrac{n}{2}}}\) цепями. Для примера \(n = 3\), это выглядит следующим образом:
    \begin{center}
        \vspace{6pt}
        \scalebox{0.8}{\includetikz{practice-04-solution-img-04.tikz}}
        \vspace{6pt}
    \end{center}
    
    В общем случае мы будем работать конструктивно. Для начала докажем техническую лемму.

    \textbf{Лемма.} \textit{Если \(\mathcal{A}\) --- произвольная коллекция \(k\)-элементных подмножеств множества \(U\) размера \(n\), то множество 
    \[
        N_{+}(\mathcal{A}) = \set{A' \subset U | \abs{A'} = k + 1 \text{ и } A' \supset A \text{ для какого-то } A \in \mathcal{A}}
    \]
    имеет размер хотя бы \(|\mathcal{A}|\) если \(k < \floor{\frac{n}{2}}\)}.

    По существу это условие Холла для двудольного графа образованого как графа включений между подмножествами размера \(k\) и \(k+1\). 

    \noindent \textit{Доказательство}. Каждое из \(k\)-элементных подмножеств в \(\mathcal{A}\) имеет \(n - k\) надмножеств размера \(k+1\), и каждое множество из \(N_{+}(\mathcal{A})\) имеет ровно \(k + 1\) подмножеств (не обязательно только из \(\mathcal{A}\)) размера \(k\). Откуда:
    \[
       |\mathcal{A}| \cdot (n - k) \leq |N_{+}(\mathcal{A})| \cdot (k + 1)
    \]
    Иначе говоря \(|N_{+}(\mathcal{A})| \geq \frac{n - k}{k + 1} |\mathcal{A}|\). В частности
    \[
       \frac{n - k}{k + 1} > 1 \text{ если } k < \floor{\frac{n}{2}}
    \]
    Ч{.}Т{.}Д{.}
     
    Теперь будем строить покрытие цепями следующим образом. Представим частично упорядоченное множество \(\mathcal{P}(U), \subseteq\) как граф, вершины которого это подмножества \(U\), и два подмножества \(A, B\) соединенны ребром, если их размеры отличаются на 1 и \(A \subseteq B\) или \(B \subseteq A\). Получим следующую картину:
    \begin{center}
        \includetikz{practice-04-solution-img-05.tikz}
    \end{center}

    Рассмотрим \enquote{слои} нашего графа, которые будут представлять собой двудольные графы построенные на множествах размера \(k\) и \(k+1\). Если \(n\) четно, то на каждом слое вплоть до \(n/2\) мы можем выбрать паросочетание покрывающее множества размера \(k\) по доказанной лемме и лемме Холла. При \(k \geq n/2\) мы можем выбрать паросочетания покрывающие множества размера \(k+1\) в силу симметрии\footnote{Можно заметить что картинка будет симметрична относительно центра: если сказать что \(A \preceq B\) если \(A \supset B\) то отображение \(A \mapsto U \setminus A\) будет осуществлять биекцию между \(\mathcal{P}(U), \subset\) и \(\mathcal{P}(U), \supset\)}. Если \(n\) нечетно, то мы делаем тоже самое со всеми слоями кроме слоя \((n-1)/2 \to (n+1)/2\): на нем мы можем выбрать совершенное паросочетание так как соответствующий граф будет регулярным двудольным графом.

    Тогда наш граф разобьётся на \(s\) непересекающихся путей. Причем каждый путь проходит через множества размера \(\ceil{\lfrac{n}{2}}\), а значит их будет ровно  \(s = C_{n}^{\ceil{\lfrac{n}{2}}}\) штук. 
    \begin{center}
        \includetikz{practice-04-solution-img-06.tikz}
    \end{center}

    Теперь, как было описано ранее, применение принципа Дирихле дает нам нужный результат и значит ответ на задачу: \(C_{n}^{\ceil{\lfrac{n}{2}}}\). 
    
    Приведем менее очевидное, но более изящное решение. Для начала заметим, что в \(\mathcal{P}(U)\) есть \(n!\) максимальных по включению цепей (т.е. цепей, которые содержат в себе пустое множество, одноэлементное множество, двухэлементное множество и т.д.) --- действительно, достаточно указать порядок в котором мы \enquote{набираем} элементы.  С другой стороны для множества \(X \subset U, |X| = k\) есть ровно \(k! \cdot (n - k)!\) максимальных цепей, которые через него проходят: есть \(k!\) способов сначала набрать элементы \(X\), а затем \((n - k)!\) способов набрать остальные элементы. В частности есть известное неравенство, согласно которому:
    \[
        k! \cdot (n - k)! \geq \floor{\lfrac{n}{2}}! \cdot \ceil{\lfrac{n}{2}}! 
    \]
    Пусть теперь \(\mathcal{A} \subset \mathcal{P}(U)\) --- коллекция подмножеств \(U\). Предположим что \(\mathcal{A}\) является антицепью. Это в частности значит, что для любых двух элементов \(A, B \in \mathcal{A}\), все максимальные по включению цепи проходящие через \(A\) отличны от всех максимальных по включению цепей проходящих через \(B\) --- если бы нашлась общая цепь, то либо \(A \subseteq B\), либо \(B \subseteq A\). Поэтому через элементы \(\mathcal{A}\) проходит как минимум
    \[
        |\mathcal{A}| \cdot \floor{\lfrac{n}{2}}! \cdot \ceil{\lfrac{n}{2}}! 
    \]
    различных максимальных по включению цепей. Но всего таких \(n!\), откуда:
    \[
    |\mathcal{A}| \cdot \floor{\lfrac{n}{2}}! \cdot \ceil{\lfrac{n}{2}}! \leq n! \Rightarrow |\mathcal{A}| \leq \frac{n!}{\floor{\lfrac{n}{2}}! \cdot \ceil{\lfrac{n}{2}}!} = C_{n}^{\ceil{\lfrac{n}{2}}}
    \]
\end{solution}
\end{document}

